<!doctype html>
<html lang="sv">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1">
<title>Viljas LÃ¤xa</title>
<meta name="theme-color" content="#0a84ff">
<link rel="manifest" href="manifest.json">
<link rel="apple-touch-icon" href="icon-512.png">
<style>
  :root{ --bg:#ffffff; --fg:#0d1321; --muted:#6b7280; --accent:#0a84ff; --ok:#2db55d; --err:#d32f2f; --card:#f8fafc; }
  *{ box-sizing:border-box }
  html,body{ margin:0; padding:0; background:var(--bg); color:var(--fg); font-family:-apple-system,system-ui,"Segoe UI",Roboto,Helvetica,Arial,sans-serif }
  .wrap{ max-width:820px; margin:0 auto; padding:24px 16px 56px }
  header{ display:flex; align-items:flex-start; gap:12px; }
  .logo{ width:44px; height:44px; border-radius:12px; background:linear-gradient(135deg,#0a84ff,#66b2ff); box-shadow:0 6px 18px rgba(10,132,255,.25); display:flex; align-items:center; justify-content:center; color:#fff; font-weight:800 }
  h1{ margin:0; font-size:26px; line-height:1.15; color:var(--accent) }
  .sub{ color:var(--muted); margin-top:2px; font-size:14px }
  .board{ margin-top:16px; display:flex; gap:10px; flex-wrap:wrap }
  .chip{ background:#eef2ff; color:#102a63; border:1px solid #dbe3ff; padding:6px 12px; border-radius:999px; font-weight:600; font-size:12px }
  .card{ background:var(--card); border:1px solid #e5e7eb; border-radius:16px; padding:18px; margin-top:14px; box-shadow:0 1px 0 rgba(2,6,23,.03) }
  .def{ font-size:20px; margin:4px 0 12px; min-height:48px }
  input[type=text]{ width:100%; font-size:20px; padding:14px 12px; border-radius:12px; border:1px solid #d1d5db; background:#fff; outline:none }
  input[type=text]:focus{ border-color:var(--accent); box-shadow:0 0 0 3px rgba(10,132,255,.15) }
  .row{ display:flex; gap:10px; flex-wrap:wrap; align-items:center; margin-top:12px }
  button{ border:none; border-radius:12px; padding:14px 16px; font-weight:800; font-size:16px; cursor:pointer }
  .primary{ background:var(--accent); color:#fff }
  .feedback{ min-height:24px; margin-top:8px; font-weight:800 }
  .ok{ color:var(--ok) } .err{ color:var(--err) }
  .done{ border:2px dashed #a7e5b7; background:#f2fff5; text-align:center; padding:20px; border-radius:16px; margin-top:16px }
  .done h2{ margin:0 0 6px; font-size:22px }
  .small{ color:var(--muted); font-size:13px }
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="logo">VL</div>
    <div>
      <h1>Hej Vilja! ðŸŒŸ</h1>
      <div class="sub">Dagens runda: klara alla ord minst en gÃ¥ng.</div>
    </div>
  </header>

  <div class="board">
    <div class="chip">Framsteg idag: <span id="progress">0/0</span></div>
    <div class="chip">RÃ¤tt i rad: <span id="streak">0</span></div>
  </div>

  <div id="practice" class="card">
    <div id="def" class="def">â€”</div>
    <input id="answer" type="text"
           placeholder="Skriv ordet â€¦"
           autocomplete="off" autocapitalize="off" autocorrect="off" spellcheck="false" inputmode="latin">
    <div class="row">
      <button id="check" type="button" class="primary">Kolla</button>
    </div>
    <div id="feedback" class="feedback"></div>
  </div>

  <div id="done" class="done" style="display:none">
    <h2>Bra jobbat, Vilja! ðŸŽ‰</h2>
    <div>Du har klarat alla ord i dagens runda.</div>
    <div class="row" style="justify-content:center; margin-top:12px">
      <button id="again" type="button" class="primary">KÃ¶r en runda till</button>
    </div>
    <div class="small" style="margin-top:8px">Du Ã¤r grym! ðŸ’™</div>
  </div>
</div>

<script>
const WORDS = [
  { w:"pengar", d:"AllmÃ¤nna medel vi betalar med, bÃ¥de sedlar och digitalt." },
  { w:"kontanter", d:"Fysiska pengar: sedlar och mynt." },
  { w:"inkomst", d:"Pengar som kommer in, t.ex. lÃ¶n eller ersÃ¤ttning." },
  { w:"skatt", d:"Pengar man betalar till staten/kommunen fÃ¶r gemensam nytta." },
  { w:"budget", d:"Plan fÃ¶r inkomster och utgifter sÃ¥ pengarna rÃ¤cker." },
  { w:"lungor", d:"Organen vi andas med, tar upp syre till blodet." },
  { w:"luftrÃ¶r", d:"RÃ¶r som leder luft till och frÃ¥n lungorna." },
  { w:"koldioxid", d:"Gas (COâ‚‚) vi andas ut; bildas nÃ¤r kroppen anvÃ¤nder energi." },
  { w:"svalg", d:"Delen lÃ¤ngst bak i mun och hals dÃ¤r luft och mat passerar." }
];
(function forceNoIOSPredict(){
  const a = document.getElementById("answer");
  ["autocorrect","autocomplete","autocapitalize","spellcheck"].forEach(attr=>{
    a.setAttribute(attr, attr==="spellcheck" ? "false" : "off");
  });
  a.setAttribute("inputmode","latin");
})();

const KEY = "vilja_pwa_cache_state_v2";
function today(){ return new Date().toISOString().slice(0,10); }
function shuffle(a){ for(let i=a.length-1;i>0;i--){ const j=(Math.random()*(i+1))|0; [a[i],a[j]]=[a[j],a[i]]; } return a; }

let state = JSON.parse(localStorage.getItem(KEY) || "{}");
function resetDay(){
  state = { date: today(), order: shuffle(WORDS.map(o=>o.w)), done: [], streak:0 };
  localStorage.setItem(KEY, JSON.stringify(state));
}
if(state.date !== today() || !Array.isArray(state.order) || !Array.isArray(state.done)){ resetDay(); }

const defEl = document.getElementById("def");
const ansEl = document.getElementById("answer");
const fbEl = document.getElementById("feedback");
const progEl = document.getElementById("progress");
const streakEl = document.getElementById("streak");
const practice = document.getElementById("practice");
const doneBox = document.getElementById("done");
const checkBtn = document.getElementById("check");
const againBtn = document.getElementById("again");

let current = null;
function updateUI(){ progEl.textContent = `${state.done.length}/${WORDS.length}`; streakEl.textContent = state.streak || 0; }
function pickNext(){
  if(state.order.length === 0){ practice.style.display="none"; doneBox.style.display="block"; return; }
  const w = state.order[state.order.length - 1];
  current = WORDS.find(o => o.w === w);
  defEl.textContent = current ? current.d : "â€”";
  ansEl.value = ""; fbEl.textContent = ""; fbEl.className = "feedback";
  requestAnimationFrame(()=>ansEl.focus()); updateUI();
}
function correct(){
  fbEl.textContent = "RÃ¤tt! ðŸŽ‰"; fbEl.className = "feedback ok";
  state.streak = (state.streak||0) + 1; state.done.push(current.w); state.order.pop();
  localStorage.setItem(KEY, JSON.stringify(state)); updateUI();
  setTimeout(pickNext, 1500);
}
function wrong(){
  fbEl.innerHTML = `NÃ¤stan! RÃ¤tt svar Ã¤r <strong>"${current.w}"</strong>`; fbEl.className = "feedback err";
  state.streak = 0; localStorage.setItem(KEY, JSON.stringify(state)); updateUI();
}
function check(){
  const v = (ansEl.value||"").trim().toLowerCase();
  if(!v || !current) return;
  if(v === current.w.toLowerCase()) correct(); else wrong();
}
checkBtn.addEventListener("click", check);
ansEl.addEventListener("keydown", e => { if(e.key === "Enter") check(); });
againBtn.addEventListener("click", ()=>{ resetDay(); practice.style.display="block"; doneBox.style.display="none"; pickNext(); });
updateUI(); pickNext();
if("serviceWorker" in navigator){ navigator.serviceWorker.register("sw.js"); }
</script>
</body>
</html>