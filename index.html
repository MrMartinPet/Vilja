<!doctype html>
<html lang="sv">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Viljas Stavningsl√§xa ‚Äì Damirs l√§xa</title>
<style>
  :root{
    --bg:#0f172a; --card:#111827; --ink:#e5e7eb; --muted:#9ca3af; --accent:#22c55e; --warn:#ef4444; --brand:#38bdf8;
  }
  *{box-sizing:border-box} body{margin:0;background:linear-gradient(180deg,#0b1222,#0f172a 40%,#0b1222);
    color:var(--ink);font-family:system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial,sans-serif}
  .wrap{max-width:880px;margin:0 auto;padding:20px 16px 64px}
  header{display:flex;align-items:center;gap:12px;margin:6px 0 18px}
  .avatar{width:54px;height:54px;border-radius:12px;background:#1f2937;display:grid;place-items:center;
    font-weight:800;color:#fff;box-shadow:0 6px 18px rgba(0,0,0,.35)}
  h1{font-size:1.6rem;line-height:1.2;margin:0}
  h1 small{display:block;font-weight:400;color:var(--muted);font-size:.9rem}
  .card{background:var(--card);border:1px solid #1f2937;border-radius:16px;padding:16px;box-shadow:0 12px 32px rgba(0,0,0,.28)}
  .row{display:flex;gap:10px;flex-wrap:wrap}
  .grow{flex:1 1 280px}
  .def{font-size:1.15rem;line-height:1.5}
  .input{display:flex;gap:10px;margin-top:12px}
  input[type=text]{flex:1;padding:14px 14px;border-radius:12px;border:1px solid #263042;background:#0b1220;color:var(--ink);
    font-size:1.1rem;outline:none}
  input[type=text].ok{border-color:var(--accent);box-shadow:0 0 0 3px #22c55e33}
  input[type=text].bad{border-color:var(--warn);box-shadow:0 0 0 3px #ef444433}
  button{padding:12px 14px;border-radius:12px;border:1px solid #263042;background:#0b1220;color:#e6edf3;cursor:pointer;
    font-weight:600}
  button.primary{background:linear-gradient(180deg,#22c55e,#16a34a);border:none}
  button.ghost{background:transparent;border:1px solid #334155}
  button:disabled{opacity:.6;cursor:not-allowed}
  .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin:12px 0}
  .pill{padding:8px 12px;border-radius:999px;border:1px solid #334155;background:#0b1220;color:#cbd5e1;font-weight:600;cursor:pointer}
  .pill.active{background:#0ea5e9;border-color:#0284c7}
  .meta{display:flex;gap:10px;align-items:center;color:var(--muted);font-size:.95rem;margin-top:10px}
  .progress{height:10px;background:#0b1220;border:1px solid #263042;border-radius:999px;overflow:hidden}
  .bar{height:100%;width:0%;background:linear-gradient(90deg,#22c55e,#84cc16)}
  .hint{color:#93c5fd;font-weight:600}
  .footer{margin-top:18px;color:var(--muted);font-size:.9rem}
  .tag{display:inline-block;margin-left:8px;padding:3px 8px;border-radius:8px;background:#0b2b3a;border:1px solid #0e7490;color:#7dd3fc}
  .center{display:grid;place-items:center}
  .fc{font-size:1.15rem;line-height:1.5;min-height:84px;display:grid;place-items:center;text-align:center}
  .fc .word{font-size:1.6rem;font-weight:800}
  .row-spaced{display:flex;justify-content:space-between;align-items:center;gap:10px}
  .muted{color:var(--muted)}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div class="avatar">V</div>
    <div>
      <h1>Hej Vilja! <small>Veckans begrepp ‚Äì ‚ÄúDamirs l√§xa‚Äù</small></h1>
      <div class="muted">Stava orden & l√§r dig vad de betyder. Du klarar det! ‚ú®</div>
    </div>
  </header>

  <div class="toolbar">
    <button class="pill active" id="modeSpell">Stava</button>
    <button class="pill" id="modeCards">L√§r-kort</button>
    <button class="pill" id="btnReset">Nollst√§ll framsteg</button>
  </div>

  <div class="card" id="spellView">
    <div class="row-spaced">
      <div class="muted">Definition</div>
      <div class="muted">Kvar: <span id="leftCount">‚Äì</span></div>
    </div>
    <div class="def" id="definition"></div>

    <div class="input">
      <input id="answer" type="text" placeholder="Skriv ordet h√§r ‚Ä¶" autocomplete="off" autocapitalize="none" />
      <button class="primary" id="checkBtn">Kolla</button>
    </div>

    <div class="toolbar">
      <button class="ghost" id="hintBtn">Ledtr√•d</button>
      <button class="ghost" id="revealBtn">Visa svar</button>
      <button class="ghost" id="skipBtn">Hoppa √∂ver</button>
      <button class="ghost" id="speakBtn">Lyssna</button>
    </div>

    <div class="meta">
      <div class="progress grow"><div class="bar" id="bar"></div></div>
      <div><span id="doneCount">0</span>/<span id="totalCount">0</span> klara</div>
    </div>
    <div class="footer">Tips: skriv <span class="hint">√• √§ √∂</span> precis som vanligt. Fel ord visas r√∂tt, r√§tt blir gr√∂nt. üíö</div>
  </div>

  <div class="card" id="cardsView" style="display:none">
    <div class="row-spaced"><div class="muted">L√§r-kort</div><div class="muted">Kort: <span id="cardIndex">1</span>/<span id="cardTotal">‚Äì</span></div></div>
    <div class="fc" id="flashArea">
      <div class="word" id="flashFront"></div>
      <div class="muted" id="flashBack" style="display:none"></div>
    </div>
    <div class="toolbar center">
      <button class="primary" id="flipBtn">V√§nd kort</button>
      <button class="ghost" id="knowBtn">Kan det ‚úÖ</button>
      <button class="ghost" id="practiceBtn">√ñva mer üîÅ</button>
      <button class="ghost" id="prevBtn">‚óÄÔ∏é</button>
      <button class="ghost" id="nextBtn">‚ñ∂Ô∏é</button>
    </div>
    <div class="meta"><div class="muted">Markerade som ‚Äúkan‚Äù: <span id="knownCount">0</span></div></div>
  </div>

  <div class="footer">Byggd bara f√∂r dig, Vilja üíô ‚Äî av pappa. <span class="tag">v1 ‚Äì SO/NO/teknik</span></div>
</div>

<script>
/* ======= 1) BYT VECKANS ORD H√ÑR ======= */
const WORDS = [
  { word: "utgifter",
    def: "Pengar som man betalar f√∂r saker man beh√∂ver, t.ex. mat, hyra och kl√§der." },
  { word: "reklam",
    def: "Budskap som ska f√• oss att l√§gga m√§rke till och vilja k√∂pa n√•got." },
  { word: "utbud",
    def: "Hur mycket av en vara eller tj√§nst som finns att s√§lja." },
  { word: "efterfr√•gan",
    def: "Hur m√•nga som vill k√∂pa en vara eller tj√§nst." },
  { word: "skelett",
    def: "Kroppens h√•rda stomme som h√•ller oss uppe och skyddar organ." },
  { word: "muskler",
    def: "Det som sitter fast p√• skelettet och g√∂r att vi kan r√∂ra oss." },
  { word: "kranium",
    def: "Skallbenet ‚Äì den del av skelettet som skyddar hj√§rnan." },
  { word: "transport",
    def: "Att flytta m√§nniskor eller saker fr√•n en plats till en annan." },
  { word: "ingenj√∂r",
    def: "En person som anv√§nder teknik och kunskap f√∂r att l√∂sa problem och bygga smarta saker." }
];

/* ======= 2) APP-LOGIK (beh√∂ver s√§llan √§ndras) ======= */
const KEY = "vilja_damirs_laxa_progress_v1";
const KNOWN_KEY = "vilja_cards_known_v1";

const $ = (id)=>document.getElementById(id);
const shuffle = arr => arr.map(v=>[Math.random(),v]).sort((a,b)=>a[0]-b[0]).map(x=>x[1]);

let order = shuffle([...WORDS.keys()]);
let idx = 0;
let progress = JSON.parse(localStorage.getItem(KEY) || "{}"); // { ord: true }
let known = JSON.parse(localStorage.getItem(KNOWN_KEY) || "{}"); // { ord: true }

const speak = (text)=>{
  if (!("speechSynthesis" in window)) return;
  const u = new SpeechSynthesisUtterance(text);
  u.lang = "sv-SE";
  u.rate = 1.0;
  u.pitch = 1.0;
  speechSynthesis.cancel();
  speechSynthesis.speak(u);
};
const beep = (ok=true)=>{
  try{
    const ctx = new (window.AudioContext||window.webkitAudioContext)();
    const o = ctx.createOscillator(); const g = ctx.createGain();
    o.type = ok ? "triangle":"sawtooth";
    o.frequency.value = ok ? 880:200;
    o.connect(g); g.connect(ctx.destination);
    g.gain.setValueAtTime(0.0001, ctx.currentTime);
    g.gain.exponentialRampToValueAtTime(0.3, ctx.currentTime+0.02);
    g.gain.exponentialRampToValueAtTime(0.0001, ctx.currentTime+0.18);
    o.start(); o.stop(ctx.currentTime+0.2);
  }catch{}
};

function saveProgress(){ localStorage.setItem(KEY, JSON.stringify(progress)); }
function saveKnown(){ localStorage.setItem(KNOWN_KEY, JSON.stringify(known)); }

function updateCounts(){
  const done = Object.keys(progress).length;
  $("doneCount").textContent = done;
  $("totalCount").textContent = WORDS.length;
  $("bar").style.width = Math.round(100*done/WORDS.length)+"%";
  $("leftCount").textContent = (WORDS.length - done);
  $("knownCount").textContent = Object.keys(known).length;
}

function loadCurrent(){
  const w = WORDS[order[idx]];
  $("definition").textContent = w.def;
  $("answer").value = "";
  $("answer").classList.remove("ok","bad");
  $("answer").focus();
  updateCounts();
}

function nextItem(){
  // flytta sv√•ra ord senare genom att l√§gga in igen n√§ra slutet
  idx++;
  if (idx>=order.length){ order = shuffle([...WORDS.keys()]); idx=0; }
  loadCurrent();
}

$("checkBtn").onclick = ()=>{
  const w = WORDS[order[idx]];
  const val = $("answer").value.trim().toLowerCase();
  const right = w.word.toLowerCase();
  if (val === right){
    $("answer").classList.remove("bad"); $("answer").classList.add("ok");
    progress[w.word] = true; saveProgress(); beep(true);
    setTimeout(nextItem, 280);
  }else{
    $("answer").classList.remove("ok"); $("answer").classList.add("bad");
    beep(false);
  }
  updateCounts();
};

$("hintBtn").onclick = ()=>{
  const w = WORDS[order[idx]].word;
  const first = w[0], last = w[w.length-1];
  const hint = `${first} _ _ ... _ ${last}  (${w.length} bokst√§ver)`;
  $("definition").innerHTML = WORDS[order[idx]].def + `<br><span class="hint">Ledtr√•d: ${hint}</span>`;
};
$("revealBtn").onclick = ()=>{
  const w = WORDS[order[idx]].word;
  $("answer").value = w;
  $("answer").classList.add("ok");
  setTimeout(()=>{$("answer").classList.remove("ok")},500);
};
$("skipBtn").onclick = nextItem;
$("speakBtn").onclick = ()=>{
  const w = WORDS[order[idx]];
  speak(`Definition: ${w.def}. Skriv ordet: ${w.word}.`);
};

$("btnReset").onclick = ()=>{
  if(confirm("Vill du nollst√§lla framstegen?")){ progress={}; known={}; saveProgress(); saveKnown(); updateCounts(); }
};

/* ----- L√§r-kort ----- */
let cardIndex = 0;
function renderCard(){
  const item = WORDS[cardIndex];
  $("flashFront").textContent = item.word;
  $("flashBack").textContent = item.def;
  $("flashBack").style.display = "none";
  $("flashFront").style.display = "block";
  $("cardIndex").textContent = (cardIndex+1);
  $("cardTotal").textContent = WORDS.length;
  updateCounts();
}
$("flipBtn").onclick = ()=>{
  const front = $("flashFront"), back = $("flashBack");
  const showBack = back.style.display === "none";
  back.style.display = showBack? "block":"none";
  front.style.display = showBack? "none":"block";
};
$("nextBtn").onclick = ()=>{ cardIndex = (cardIndex+1)%WORDS.length; renderCard(); };
$("prevBtn").onclick = ()=>{ cardIndex = (cardIndex-1+WORDS.length)%WORDS.length; renderCard(); };
$("knowBtn").onclick = ()=>{ known[WORDS[cardIndex].word] = true; saveKnown(); updateCounts(); beep(true); };
$("practiceBtn").onclick = ()=>{ delete known[WORDS[cardIndex].word]; saveKnown(); updateCounts(); };

function switchMode(mode){
  const spell = $("spellView"), cards = $("cardsView");
  $("modeSpell").classList.toggle("active", mode==="spell");
  $("modeCards").classList.toggle("active", mode==="cards");
  spell.style.display = mode==="spell"?"block":"none";
  cards.style.display = mode==="cards"?"block":"none";
}
$("modeSpell").onclick = ()=>switchMode("spell");
$("modeCards").onclick = ()=>{ switchMode("cards"); renderCard(); };

/* Init */
updateCounts();
loadCurrent();
renderCard();

/* Enter f√∂r snabb kontroll */
$("answer").addEventListener("keydown", (e)=>{
  if(e.key==="Enter"){ $("checkBtn").click(); }
});
</script>
</body>
</html>